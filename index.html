<!DOCTYPE html> 
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>TECH4ZERO – Educational Designs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    body { margin:0; font-family:'Open Sans', Arial, sans-serif; background-color:#1E2F3F; color:#ffffff; }

    header { padding:40px 20px; text-align:center; background:linear-gradient(180deg, #1E2F3F, #16222D); }
    header h1 { font-family:'Playfair Display', serif; font-size:48px; margin:0; }
    header p { color:#D6A21C; letter-spacing:2px; margin-top:10px; font-size:14px; }

    nav { display:flex; justify-content:center; gap:15px; padding:15px; background-color:#16222D; flex-wrap:wrap; }
    nav a { background-color:#1E2F3F; color:white; padding:8px 18px; border-radius:20px; text-decoration:none; font-size:14px; font-weight:600; }
    nav a:hover { background-color:#D6A21C; color:#16222D; }

    /* Session bar */
    .sessionBar {
      display:flex;
      justify-content:center;
      align-items:center;
      gap:12px;
      padding:10px 15px;
      background:#0f1d27;
      border-bottom:1px solid #365468;
      flex-wrap:wrap;
    }
    .sessionBadge {
      padding:6px 12px;
      border-radius:999px;
      font-size:13px;
      font-weight:700;
      border:1px solid #365468;
      background:#1E2F3F;
    }
    .badgeOk { color:#b9ffcf; }
    .badgeNo { color:#ffdca8; }

    section { display:none; padding:50px 20px; max-width:1000px; margin:auto; }
    section.active { display:block; }

    h2 { font-family:'Playfair Display', serif; color:#D6A21C; font-size:32px; margin-top:0; }

    .card { background-color:#243A4B; padding:25px; border-radius:8px; margin-top:25px; }

    footer { text-align:center; padding:30px; font-size:13px; background-color:#16222D; margin-top:50px; }

    /* Buttons */
    .btnPrimary { padding:10px 16px; font-weight:700; border-radius:6px; border:none; cursor:pointer; }
    .btnSecondary { padding:10px 16px; font-weight:600; border-radius:6px; border:1px solid #D6A21C; background:transparent; color:#D6A21C; cursor:pointer; }
    .btnPrimary:disabled, .btnSecondary:disabled {
      opacity:0.45;
      cursor:not-allowed;
    }

    /* Compact panel + stacked inputs */
    .formPanel {
      margin-top: 18px;
      background: #1E2F3F;
      padding: 16px;
      border-radius: 8px;
      max-width: 520px;
      border: 1px solid #365468;
    }
    .fieldBlock { margin-bottom: 14px; }
    .fieldLabel { font-weight:600; display:inline-block; margin-bottom:6px; }
    .textInput {
      width:100%;
      max-width:380px;
      padding:8px;
      border-radius:6px;
      border:1px solid #365468;
      background:#0f1d27;
      color:#ffffff;
      outline:none;
    }
    .textInput::placeholder { color:#a9c0d3; }

    .statusMsg { margin-top:12px; font-weight:600; min-height:18px; }
    .statusOk { color:#b9ffcf; }
    .statusWarn { color:#ffdca8; }
    .statusErr { color:#ffb4b4; }

    /* Modal */
    .modalOverlay {
      display:none;
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.65);
      z-index:9999;
      align-items:center;
      justify-content:center;
      padding:18px;
    }
    .modalBox {
      width:min(620px, 95vw);
      background:#16222D;
      border:1px solid #365468;
      border-radius:12px;
      padding:18px;
      box-shadow:0 20px 60px rgba(0,0,0,0.35);
    }
    .modalHeader {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom:10px;
    }
    .modalTitle {
      font-family:'Playfair Display', serif;
      color:#D6A21C;
      font-size:22px;
      margin:0;
    }
    .modalClose {
      background:transparent;
      border:1px solid #365468;
      color:#fff;
      border-radius:8px;
      padding:6px 10px;
      cursor:pointer;
      font-weight:700;
    }

   .navAccess {
      margin-left: 40px;
   } 
  </style>

  <script>
    function showTab(tabId) {
      document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
      if (tabId === 'datos') window.loadDatosIfNeeded?.();
    }
  </script>
</head>

<body>

<header>
  <h1>TECH4ZERO</h1>
  <p>EDUCATION+IA</p>
</header>

<nav>
  <a href="#" onclick="showTab('home'); return false;">INICIO</a>
  <a href="#" onclick="showTab('programa'); return false;">PROGRAMA</a>
  <a href="#" onclick="showTab('encuesta'); return false;">ENCUESTA</a>
  <a href="#" onclick="showTab('datos'); return false;">DATOS</a>
  <a href="#" onclick="showTab('resultados'); return false;">RESULTADOS</a>
  <a href="#" onclick="showTab('equipo'); return false;">EQUIPO</a>
  <a href="#" onclick="showTab('contacto'); return false;">CONTACTO</a>

  <button id="btnAccesoUsuarios" class="btnPrimary navAccess" type="button">ACCESO USUARIOS </button>
</nav>

<!-- BARRA GLOBAL DE SESIÓN -->
<div class="sessionBar">
  <span id="sessionBadge" class="sessionBadge badgeNo">No autenticado</span>
</div>

<section id="home" class="active">
  <h2>Bienvenidos</h2>

  <div class="card">
    <p>
      TECH4ZERO desarrolla programas educativos basados en experiencia,
      cooperación, lenguaje y emociones, con foco en la prevención del bullying.
    </p>
  </div>

  <div class="card" style="margin-top:30px; text-align:center;">
    <iframe width="560" height="315"
      src="https://www.youtube.com/embed/iBO4YijRYbs"
      title="Programa ZERO"
      frameborder="0"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
      allowfullscreen>
    </iframe>
  </div>

  <div style="margin-top:30px; text-align:center;">
    <img src="zero.png" alt="Logo ZERO" style="max-width:220px;" />
  </div>
</section>

<section id="programa">
  <h2>Programa Antibullying TECH4ZERO</h2>
  <div class="card">
    <p>
      Programa antibullying internacional, implementado en escuelas de Estados Unidos
      y Latinoamérica, con resultados comprobados.
    </p>
  </div>
</section>

<section id="encuesta">
  <h2>Encuesta Escolar</h2>

  <div class="card">
    <p>
      Para ingresar a la encuesta y solicitar análisis, debe estar autenticado desde <b>ACCESO USUARIOS</b>.
    </p>

    <!-- OK Panel (acciones) -->
    <div id="encuestaOK" class="formPanel" style="display:block; max-width:520px;">
      <p id="schoolWelcome" style="margin:0 0 12px 0;">Estado de sesión: No autenticado.</p>

      <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
        <button id="btnIngresarEncuesta" class="btnPrimary" type="button">Ingresar a la encuesta</button>
        <button id="btnSolicitarAnalisis" class="btnSecondary" type="button">Solicitar analisis de la encuesta</button>
      </div>

      <div id="encuestaNeedLogin" class="statusMsg statusWarn" style="display:none;">
        Debe iniciar sesión con <b>ACCESO USUARIOS</b> para continuar.
      </div>
    </div>

    <!-- Warning Panel: Solicitar análisis -->
    <div id="analisisWarnPanel" class="formPanel" style="display:none; max-width:520px; border:1px solid #D6A21C;">
      <div style="font-weight:700; margin-bottom:10px;">Advertencia</div>
      <div style="margin-bottom:14px;">
        El sistema realizara un analisis estadistico detallado del ambiente escolar con las encuestas introducidas en el sistema para su escuela, pero no podra adicionar nuevas encuestas.
        <br /><br />
        Desea continuar?
      </div>

      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <button id="btnAnalisisContinuar" class="btnPrimary" type="button">Continuar</button>
        <button id="btnAnalisisCancelar" class="btnSecondary" type="button">Cancelar</button>
      </div>
    </div>

    <!-- Survey Box -->
    <div id="surveyBox" class="formPanel" style="display:none; margin-top:18px;">
      <div id="qTitle" style="font-weight:700; margin-bottom:10px;"></div>
      <div id="qText" style="margin-bottom:12px;"></div>
      <div id="qOptions"></div>

      <div style="display:flex; gap:10px; margin-top:14px; flex-wrap:wrap;">
        <button id="btnQPrev" class="btnSecondary" type="button">Anterior</button>
        <button id="btnQNext" class="btnPrimary" type="button">Siguiente</button>
      </div>

      <div id="surveyMsg" class="statusMsg statusWarn"></div>
    </div>

  </div>
</section>

<section id="resultados">
  <h2>Resultados Encuesta</h2>

  <div class="card">
    <p>
      Para ver resultados debe estar autenticado desde <b>ACCESO USUARIOS</b>.
    </p>

    <div class="formPanel" style="display:block; max-width:520px;">
      <div id="resultadosNeedLogin" class="statusMsg statusWarn" style="display:none;">
        Debe iniciar sesión con <b>ACCESO USUARIOS</b> para mostrar resultados.
      </div>

      <div style="margin-top:10px;">
        <button id="btnMostrarResultados" class="btnPrimary" type="button">
          Mostrar resultados encuesta
        </button>
      </div>
    </div>

  </div>
</section>

<section id="datos">
  <h2>Datos</h2>

  <div class="card">
    <p>
      Esta sección lee datos desde Supabase (tabla <b>encargado_escolar</b>) para verificar conexión.
    </p>

    <div class="formPanel">
      <div class="fieldBlock">
        <label class="fieldLabel" for="d_nombre">Nombre</label><br />
        <input id="d_nombre" class="textInput" type="text" placeholder="Nombre" readonly />
      </div>

      <div class="fieldBlock">
        <label class="fieldLabel" for="d_ap_paterno">Apellido Paterno</label><br />
        <input id="d_ap_paterno" class="textInput" type="text" placeholder="Apellido Paterno" readonly />
      </div>

      <div class="fieldBlock">
        <label class="fieldLabel" for="d_ap_materno">Apellido Materno</label><br />
        <input id="d_ap_materno" class="textInput" type="text" placeholder="Apellido Materno" readonly />
      </div>

      <div class="fieldBlock">
        <label class="fieldLabel" for="d_establecimiento">Establecimiento</label><br />
        <input id="d_establecimiento" class="textInput" type="text" placeholder="Establecimiento" readonly />
      </div>

      <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:8px;">
        <button id="btnPrev" class="btnSecondary" type="button">Retroceder</button>
        <button id="btnNext" class="btnPrimary" type="button">Avanzar</button>
      </div>

      <div id="datosStatus" class="statusMsg statusWarn"></div>
    </div>
  </div>
</section>

<section id="equipo">
  <h2>Nuestro Equipo</h2>
  <div class="card">
    <p>
      Equipo interdisciplinario de especialistas en educación, psicología y tecnología
      comprometidos con comunidades escolares seguras.
    </p>
  </div>
</section>

<section id="contacto">
  <h2>Contáctenos</h2>
  <div class="card">
    <p>Email: contacto@tech4zero.org</p>
  </div>
</section>

<footer>
  © 2025 TECH4ZERO – EDUCATION+AI
</footer>

<!-- MODAL GLOBAL: ACCESO USUARIOS -->
<div id="globalModal" class="modalOverlay">
  <div class="modalBox">
    <div class="modalHeader">
      <h3 class="modalTitle">Acceso Usuarios</h3>
      <button id="modalClose" class="modalClose" type="button">X</button>
    </div>
