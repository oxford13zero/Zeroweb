<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>TECH4ZERO – Educational Designs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    body { margin:0; font-family:'Open Sans', Arial, sans-serif; background:#1E2F3F; color:white; }
    header { padding:40px 20px; text-align:center; background:#16222D; }
    header h1 { font-family:'Playfair Display', serif; font-size:48px; margin:0; }
    header p { color:#D6A21C; margin-top:10px; letter-spacing:2px; }

    nav { display:flex; justify-content:center; gap:15px; padding:15px; background:#16222D; }
    nav a { background:#1E2F3F; padding:8px 18px; border-radius:20px; text-decoration:none; color:white; font-weight:600; }
    nav a:hover { background:#D6A21C; color:#16222D; }

    section { display:none; padding:50px 20px; max-width:1000px; margin:auto; }
    section.active { display:block; }

    h2 { color:#D6A21C; font-family:'Playfair Display', serif; }

    .card { background:#243A4B; padding:25px; border-radius:8px; margin-top:25px; }

    .formPanel { background:#1E2F3F; padding:16px; border-radius:8px; max-width:420px; border:1px solid #365468; }

    .fieldBlock { margin-bottom:14px; }
    .fieldLabel { font-weight:600; }
    .textInput {
      width:100%;
      padding:8px;
      border-radius:6px;
      border:1px solid #365468;
      background:#0f1d27;
      color:white;
    }

    .btnPrimary { padding:10px 18px; font-weight:700; border:none; border-radius:6px; cursor:pointer; }
    .btnSecondary { padding:10px 18px; border-radius:6px; border:1px solid #D6A21C; background:transparent; color:#D6A21C; cursor:pointer; }

    .statusErr { color:#ffb4b4; font-weight:600; margin-top:10px; }

    footer { text-align:center; padding:30px; background:#16222D; margin-top:50px; }
  </style>

  <script>
    function showTab(id) {
      document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }
  </script>
</head>

<body>

<header>
  <h1>TECH4ZERO</h1>
  <p>EDUCATIONAL DESIGNS</p>
</header>

<nav>
  <a href="#" onclick="showTab('home')">INICIO</a>
  <a href="#" onclick="showTab('encuesta')">ENCUESTA</a>
</nav>

<section id="home" class="active">
  <h2>Bienvenidos</h2>
  <div class="card">
    Plataforma educativa para prevención del bullying.
  </div>
</section>

<!-- ===================== ENCUESTA ===================== -->
<section id="encuesta">
  <h2>Encuesta Escolar</h2>

  <div class="card">

    <!-- INTRO -->
    <div id="encuestaIntro">
      <p>Ingrese usuario y contraseña para acceder a la encuesta.</p>
      <button id="btnMostrarLogin" class="btnPrimary">Ingresar a la encuesta</button>
    </div>

    <!-- LOGIN -->
    <div id="loginPanel" class="formPanel" style="display:none; margin-top:20px;">
      <div class="fieldBlock">
        <label class="fieldLabel">Usuario</label><br>
        <input id="loginUser" class="textInput" type="text">
      </div>

      <div class="fieldBlock">
        <label class="fieldLabel">Contraseña</label><br>
        <input id="loginPass" class="textInput" type="password">
      </div>

      <button id="btnLogin" class="btnPrimary">Entrar</button>
      <button id="btnCancelarLogin" class="btnSecondary">Cancelar</button>

      <div id="loginMsg" class="statusErr"></div>
    </div>

    <!-- OK -->
    <div id="encuestaOK" class="formPanel" style="display:none; margin-top:20px;">
      <p>Acceso concedido. Aquí comienza la encuesta.</p>
    </div>

  </div>
</section>

<footer>
  © 2025 TECH4ZERO
</footer>

<script>
  const btnMostrarLogin = document.getElementById('btnMostrarLogin');
  const btnCancelarLogin = document.getElementById('btnCancelarLogin');
  const btnLogin = document.getElementById('btnLogin');
  const loginPanel = document.getElementById('loginPanel');
  const encuestaIntro = document.getElementById('encuestaIntro');
  const encuestaOK = document.getElementById('encuestaOK');
  const loginMsg = document.getElementById('loginMsg');

  btnMostrarLogin.onclick = () => {
    encuestaIntro.style.display = 'none';
    loginPanel.style.display = 'block';
  };

  btnCancelarLogin.onclick = () => {
    loginPanel.style.display = 'none';
    encuestaIntro.style.display = 'block';
    loginMsg.textContent = '';
  };

  // ===== LOGIN REAL (BACKEND) =====
  btnLogin.onclick = async () => {
    const username = document.getElementById('loginUser').value.trim();
    const password = document.getElementById('loginPass').value.trim();

    if (!username || !password) {
      loginMsg.textContent = 'Debe ingresar usuario y contraseña.';
      return;
    }

    loginMsg.textContent = 'Validando...';

    try {
      const res = await fetch('/api/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username, password })
      });

      const data = await res.json();

      if (!res.ok || !data.ok) {
        loginMsg.textContent = 'Usuario o contraseña incorrecta.';
        return;
      }

      // OK
      loginPanel.style.display = 'none';
      encuestaOK.style.display = 'block';

    } catch (e) {
      loginMsg.textContent = 'Error de conexión.';
    }
  };
</script>

</body>
</html>
